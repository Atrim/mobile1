<!DOCTYPE html>
<html>
	<head>
		<title>StarTrackr: Spot</title>

		<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="apple-mobile-web-app-capable" content="yes" />

		<link type="text/css" rel="stylesheet" href="../stylesheets/screen.css" media="screen"/>
		<link type="text/css" rel="stylesheet" href="../stylesheets/transitions.css" media="screen"/>
		<style type="text/css" media="screen">
			#pages {
				position: relative;
			}
			#pages > div {
				display:none;
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				/* Ex 03-03-c - with opera mobile */
				-o-transition-property: -o-transform; 
				-o-transition-duration: 300ms;
				
			}
			#pages > div.current {
				display: block;
			}
			#header {
				position: relative;
			}
			#header .back{
	        display: none;
	      }
	      #page-spot .back{
	        display: block !important;
	      }

		</style>
	</head>
	<body>
		<ul id="tab-bar">
			<li id="tab-spots">
				<a data-load="spots" href="../spots.html">
				Spots
				</a>
			</li>		 
			<li id="tab-sighting">
				<a data-load="sightings" href="../new.html">
				Add a sighting
				</a>
			</li>
			<li  id="tab-stars">
				<a data-load="stars" href="../stars.html">
				Stars
				</a>
			</li>
		</ul><!-- #tab-bar -->
		<div id="pages">
			<div id="spots"></div>
			<div id="sightings"></div>
			<div id="stars"></div>
		</div>

		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
		<script type="text/javascript">
			if(!window.jQuery){
				document.write(unescape('%3Cscript src="../javascripts/vendor/jquery-1.5.min.js"%3E%3C/script%3E'));
			}
		</script>
		<script type="text/javascript" src="../javascripts/vendor/modernizr-1.7.min.js"></script>
		<script type="text/javascript">
			$(document).ready(function(){
			/*
				// Ex 04-01a - just loading the first page in manually
				$("#tab-spots a").click(function(e){
					e.preventDefault();
					$("#pages #spots").load("../spots.html #wrapper", function(){
						$("body").attr("id", "page-spots");
						transition(this, "fade");
					});
				});
			*/
				// Ex 04-01b & c: generalising the page load
				loadPage("../spots.html", "spots");
				
				// Ex 04-01c - Hook up links to hijack
				$("#tab-bar a").click("click", function(e){
					e.preventDefault();
					var url = e.target.href;
					var pageName = $(this).attr("data-load");

					loadPage(url, pageName);
				});

			});
			
			// Ex 04-01b - function for loading
			function loadPage(url, pageName, trans) {
				$("#pages #" + pageName).load(url + "?" + new Date().getTime() + " #wrapper", function(){
					$("body").attr("id", "page-" + pageName);
					transition(this, trans || "show", false);
				});
			};
			
			function transition(toPage, type, reverse){
				var toPage = $(toPage),
					fromPage = $("#pages .current"),
					reverse = reverse ? "reverse" : "";

				if(toPage.hasClass("current") || toPage === fromPage) { 
					return; 
				};
				toPage
					.addClass("current " + type + " in " + reverse)
					.one("webkitAnimationEnd", function(){
						fromPage.removeClass("current " + type + " out " + reverse);
						toPage.removeClass(type + " in " + reverse);
					});
				fromPage.addClass(type + " out " + reverse);
			}

		</script>
  </body>
</html>